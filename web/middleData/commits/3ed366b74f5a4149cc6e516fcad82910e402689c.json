{"sha":"3ed366b74f5a4149cc6e516fcad82910e402689c","commit":{"author":{"name":"Gennady Azarenkov","email":"gazarenk@redhat.com","date":"2018-04-16T14:15:44Z"},"committer":{"name":"GitHub","email":"noreply@github.com","date":"2018-04-16T14:15:44Z"},"message":"Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined  (#9440)\n\n* Adding pipeline\r\n\r\n* del jenkinsfile\r\n\r\n* Make exec agent not to use setsid for other than Linux envs\r\n\r\n* revert pom.xml\r\n\r\n* goformat\r\n\r\n* get projects folder from workkspace configuration\r\n\r\n* Merge remote-tracking branch 'upstream/master'\r\n\r\n* clean code\r\n\r\n* clean code\r\n\r\n* Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined\r\n\r\n* Revert \"Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined\"\r\n\r\nThis reverts commit 127a79e54c3e7f97a74f0103506025eb5e181777.\r\n\r\n* Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined","tree":{"sha":"d2ff6125f319c3871b7194b6e9ff360b38f61a37","url":"https://api.github.com/repos/eclipse/che/git/trees/d2ff6125f319c3871b7194b6e9ff360b38f61a37"},"url":"https://api.github.com/repos/eclipse/che/git/commits/3ed366b74f5a4149cc6e516fcad82910e402689c","comment_count":0,"verification":{"verified":true,"reason":"valid","signature":"-----BEGIN PGP SIGNATURE-----\n\nwsBcBAABCAAQBQJa1LAQCRBK7hj4Ov3rIwAAdHIIABXdzUONcq+Qe/Da7Mo8du9C\nWypbRctaSp6rd3cSv1rea+N1ZymuzLqMDLxcgFkaUx3N6LYY8O1Xu3Hbfe8B6CDG\n62Sg3KDGuDEt/hdfck2wwK4mukuoDRPO2F6XGERd48TjZ+BRR2Mp3cwlUqZX5qZb\nxXHM5v9WsvT9u7Im3g1r+sysBptNMqhiv0riMrm+4pOZhlLluR4YA3VfigGa3gR5\nZvMofxca37oW/6uImSTqod3kMer0yEg/8DIbicJLA8JRNNpfhlG23aftKspnpzdO\nvsxlA9Lo8gr4i9+mBQFI7N0EI4jp28X1Tbx042H+/3k2l6nj0ygcpl4uMFApfu8=\n=0sXt\n-----END PGP SIGNATURE-----\n","payload":"tree d2ff6125f319c3871b7194b6e9ff360b38f61a37\nparent 689e123f28bdb3ebd2575b133ad4c40a18686ff8\nauthor Gennady Azarenkov <gazarenk@redhat.com> 1523888144 +0300\ncommitter GitHub <noreply@github.com> 1523888144 +0300\n\nFix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined  (#9440)\n\n* Adding pipeline\r\n\r\n* del jenkinsfile\r\n\r\n* Make exec agent not to use setsid for other than Linux envs\r\n\r\n* revert pom.xml\r\n\r\n* goformat\r\n\r\n* get projects folder from workkspace configuration\r\n\r\n* Merge remote-tracking branch 'upstream/master'\r\n\r\n* clean code\r\n\r\n* clean code\r\n\r\n* Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined\r\n\r\n* Revert \"Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined\"\r\n\r\nThis reverts commit 127a79e54c3e7f97a74f0103506025eb5e181777.\r\n\r\n* Fix calculation Projects Root so it wont cause NPE if there are no 'project' volume defined\r\n"}},"url":"https://api.github.com/repos/eclipse/che/commits/3ed366b74f5a4149cc6e516fcad82910e402689c","html_url":"https://github.com/eclipse/che/commit/3ed366b74f5a4149cc6e516fcad82910e402689c","comments_url":"https://api.github.com/repos/eclipse/che/commits/3ed366b74f5a4149cc6e516fcad82910e402689c/comments","author":{"login":"gazarenkov","id":578124,"avatar_url":"https://avatars0.githubusercontent.com/u/578124?v=4","gravatar_id":"","url":"https://api.github.com/users/gazarenkov","html_url":"https://github.com/gazarenkov","followers_url":"https://api.github.com/users/gazarenkov/followers","following_url":"https://api.github.com/users/gazarenkov/following{/other_user}","gists_url":"https://api.github.com/users/gazarenkov/gists{/gist_id}","starred_url":"https://api.github.com/users/gazarenkov/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gazarenkov/subscriptions","organizations_url":"https://api.github.com/users/gazarenkov/orgs","repos_url":"https://api.github.com/users/gazarenkov/repos","events_url":"https://api.github.com/users/gazarenkov/events{/privacy}","received_events_url":"https://api.github.com/users/gazarenkov/received_events","type":"User","site_admin":false},"committer":{"login":"web-flow","id":19864447,"avatar_url":"https://avatars3.githubusercontent.com/u/19864447?v=4","gravatar_id":"","url":"https://api.github.com/users/web-flow","html_url":"https://github.com/web-flow","followers_url":"https://api.github.com/users/web-flow/followers","following_url":"https://api.github.com/users/web-flow/following{/other_user}","gists_url":"https://api.github.com/users/web-flow/gists{/gist_id}","starred_url":"https://api.github.com/users/web-flow/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/web-flow/subscriptions","organizations_url":"https://api.github.com/users/web-flow/orgs","repos_url":"https://api.github.com/users/web-flow/repos","events_url":"https://api.github.com/users/web-flow/events{/privacy}","received_events_url":"https://api.github.com/users/web-flow/received_events","type":"User","site_admin":false},"parents":[{"sha":"689e123f28bdb3ebd2575b133ad4c40a18686ff8","url":"https://api.github.com/repos/eclipse/che/commits/689e123f28bdb3ebd2575b133ad4c40a18686ff8","html_url":"https://github.com/eclipse/che/commit/689e123f28bdb3ebd2575b133ad4c40a18686ff8"}],"stats":{"total":34,"additions":23,"deletions":11},"files":[{"sha":"ca95079da643fd17089123dd169f4820190c4e0f","filename":"ide/che-core-ide-api/src/main/java/org/eclipse/che/ide/api/workspace/model/MachineConfigImpl.java","status":"modified","additions":10,"deletions":0,"changes":10,"blob_url":"https://github.com/eclipse/che/blob/3ed366b74f5a4149cc6e516fcad82910e402689c/ide/che-core-ide-api/src/main/java/org/eclipse/che/ide/api/workspace/model/MachineConfigImpl.java","raw_url":"https://github.com/eclipse/che/raw/3ed366b74f5a4149cc6e516fcad82910e402689c/ide/che-core-ide-api/src/main/java/org/eclipse/che/ide/api/workspace/model/MachineConfigImpl.java","contents_url":"https://api.github.com/repos/eclipse/che/contents/ide/che-core-ide-api/src/main/java/org/eclipse/che/ide/api/workspace/model/MachineConfigImpl.java?ref=3ed366b74f5a4149cc6e516fcad82910e402689c","patch":"@@ -18,6 +18,7 @@\n import org.eclipse.che.api.core.model.workspace.config.MachineConfig;\n import org.eclipse.che.api.core.model.workspace.config.ServerConfig;\n import org.eclipse.che.api.core.model.workspace.config.Volume;\n+import org.eclipse.che.commons.annotation.Nullable;\n \n public class MachineConfigImpl implements MachineConfig {\n \n@@ -110,6 +111,15 @@ public MachineConfigImpl(MachineConfig machine) {\n     return volumes;\n   }\n \n+  /**\n+   * @param name\n+   * @return volume by name or null if no such volume defined\n+   */\n+  @Nullable\n+  public VolumeImpl getVolume(String name) {\n+    return volumes.get(name);\n+  }\n+\n   @Override\n   public boolean equals(Object obj) {\n     if (this == obj) {"},{"sha":"bbde5b3bdabace451cdd48a107d42bed32dd9fc0","filename":"ide/che-core-ide-app/src/main/java/org/eclipse/che/ide/context/AppContextImpl.java","status":"modified","additions":13,"deletions":11,"changes":24,"blob_url":"https://github.com/eclipse/che/blob/3ed366b74f5a4149cc6e516fcad82910e402689c/ide/che-core-ide-app/src/main/java/org/eclipse/che/ide/context/AppContextImpl.java","raw_url":"https://github.com/eclipse/che/raw/3ed366b74f5a4149cc6e516fcad82910e402689c/ide/che-core-ide-app/src/main/java/org/eclipse/che/ide/context/AppContextImpl.java","contents_url":"https://api.github.com/repos/eclipse/che/contents/ide/che-core-ide-app/src/main/java/org/eclipse/che/ide/context/AppContextImpl.java?ref=3ed366b74f5a4149cc6e516fcad82910e402689c","patch":"@@ -52,6 +52,7 @@\n import org.eclipse.che.ide.api.workspace.WsAgentServerUtil;\n import org.eclipse.che.ide.api.workspace.event.WorkspaceStoppedEvent;\n import org.eclipse.che.ide.api.workspace.model.ServerImpl;\n+import org.eclipse.che.ide.api.workspace.model.VolumeImpl;\n import org.eclipse.che.ide.api.workspace.model.WorkspaceImpl;\n import org.eclipse.che.ide.project.node.SyntheticNode;\n import org.eclipse.che.ide.resource.Path;\n@@ -92,6 +93,7 @@\n   private CurrentUser currentUser;\n   private WorkspaceImpl workspace;\n   private FactoryImpl factory;\n+\n   private ResourceManager resourceManager;\n   private Map<String, String> properties;\n \n@@ -283,17 +285,17 @@ public Path getProjectsRoot() {\n           wsAgentServerUtilProvider.get().getWsAgentServerMachine().get().getName();\n       String activeEnv = workspace.getRuntime().getActiveEnv();\n \n-      projectsRoot =\n-          Path.valueOf(\n-              workspace\n-                  .getConfig()\n-                  .getEnvironments()\n-                  .get(activeEnv)\n-                  .getMachines()\n-                  .get(machineName)\n-                  .getVolumes()\n-                  .get(\"projects\")\n-                  .getPath());\n+      VolumeImpl vol =\n+          workspace\n+              .getConfig()\n+              .getEnvironments()\n+              .get(activeEnv)\n+              .getMachines()\n+              .get(machineName)\n+              .getVolume(\"projects\");\n+\n+      // if voulme exists return its path, otherwise use backward compatible path (/projects)\n+      if (vol != null) projectsRoot = Path.valueOf(vol.getPath());\n     }\n \n     Log.debug("}]}
